# Plugin Resource Utilities


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Plugin Type Detection

Helper functions to determine if a plugin is local vs API-based.

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-resources/blob/main/cjm_fasthtml_resources/utils/plugin_utils.py#L15"
target="_blank" style="float:right; font-size:smaller">source</a>

### is_local_plugin

>  is_local_plugin (plugin_meta)

*Check if a plugin is local (vs API-based).*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>plugin_meta</td>
<td></td>
<td>Plugin metadata with config_schema attribute</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>bool</strong></td>
<td><strong>True if plugin is local, False if API-based</strong></td>
</tr>
</tbody>
</table>

Example plugin metadata structure:

``` python
# Local plugin (works with any metadata object with config_schema)
local_plugin = PluginMetadata(
    name="whisper",
    config_schema={
        "properties": {
            "model_id": {"type": "string"},
            "device": {"type": "string"}
        }
    }
)

# API-based plugin  
api_plugin = PluginMetadata(
    name="openai-whisper",
    config_schema={
        "properties": {
            "api_key": {"type": "string"},  # Presence of api_key indicates API-based
            "model": {"type": "string"}
        }
    }
)
```

**Compatibility**: These utilities are compatible with: -
`PluginMetadata` from `cjm-fasthtml-plugins` - `SimplePluginRegistry`
from `cjm-fasthtml-settings` - `UnifiedPluginRegistry` from
`cjm-fasthtml-plugins` - Any custom object with a `config_schema`
attribute

## GPU Detection

Helper functions to determine if a plugin will use GPU resources.

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-resources/blob/main/cjm_fasthtml_resources/utils/plugin_utils.py#L27"
target="_blank" style="float:right; font-size:smaller">source</a>

### uses_gpu_device

>  uses_gpu_device (plugin_config:Dict[str,Any])

*Check if a plugin is configured to use GPU.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>plugin_config</td>
<td>Dict</td>
<td>The plugin’s current configuration</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>bool</strong></td>
<td><strong>True if plugin will use GPU, False otherwise</strong></td>
</tr>
</tbody>
</table>

``` python
# Example: Check various device configurations
configs = [
    {"device": "cuda"},
    {"device": "cuda:0"},
    {"device": "cpu"},
    {"device": "auto"},
    {"device": "mps"},
    {}  # No device specified
]

for config in configs:
    device = config.get("device", "(not specified)")
    uses_gpu = uses_gpu_device(config)
    print(f"Device '{device}': GPU={uses_gpu}")
```

    Device 'cuda': GPU=True
    Device 'cuda:0': GPU=True
    Device 'cpu': GPU=False
    Device 'auto': GPU=True
    Device 'mps': GPU=True
    Device '(not specified)': GPU=False

## Resource Identifier Extraction

Extract the plugin resource identifier (model ID, model path, etc.) from
configuration.

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-resources/blob/main/cjm_fasthtml_resources/utils/plugin_utils.py#L42"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_plugin_resource_identifier

>  get_plugin_resource_identifier (plugin_config:Dict[str,Any])

*Extract the plugin resource identifier from plugin configuration.
Checks common plugin resource configuration keys like ‘resource_id’,
‘model_id’, ‘model’, ‘model_name’, etc.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>plugin_config</td>
<td>Dict</td>
<td>The plugin’s configuration</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>Optional</strong></td>
<td><strong>Plugin resource identifier string, or None if not
found</strong></td>
</tr>
</tbody>
</table>

``` python
# Example: Extract resource identifiers from different configs
configs = [
    {"model_id": "whisper-large-v3", "device": "cuda"},
    {"model": "llama-3.1-8b", "device": "auto"},
    {"model_path": "/models/custom-model", "device": "cpu"},
    {"device": "cuda"}  # No resource ID
]

for config in configs:
    resource_id = get_plugin_resource_identifier(config)
    print(f"Config {config}: Resource ID = {resource_id}")
```

    Config {'model_id': 'whisper-large-v3', 'device': 'cuda'}: Resource ID = whisper-large-v3
    Config {'model': 'llama-3.1-8b', 'device': 'auto'}: Resource ID = llama-3.1-8b
    Config {'model_path': '/models/custom-model', 'device': 'cpu'}: Resource ID = /models/custom-model
    Config {'device': 'cuda'}: Resource ID = None

## Resource Comparison

Compare two plugin configurations to determine if they use the same
resource.

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-resources/blob/main/cjm_fasthtml_resources/utils/plugin_utils.py#L55"
target="_blank" style="float:right; font-size:smaller">source</a>

### compare_plugin_resources

>  compare_plugin_resources (config1:Dict[str,Any], config2:Dict[str,Any])

*Compare two plugin configurations to see if they use the same plugin
resource.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>config1</td>
<td>Dict</td>
<td>First plugin configuration</td>
</tr>
<tr>
<td>config2</td>
<td>Dict</td>
<td>Second plugin configuration</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>bool</strong></td>
<td><strong>True if both configs specify the same plugin resource, False
otherwise</strong></td>
</tr>
</tbody>
</table>

``` python
# Example: Compare configurations
config_a = {"model_id": "whisper-large-v3", "device": "cuda"}
config_b = {"model_id": "whisper-large-v3", "device": "cpu"}  # Same resource, different device
config_c = {"model_id": "whisper-medium", "device": "cuda"}  # Different resource

print(f"A vs B (same resource): {compare_plugin_resources(config_a, config_b)}")
print(f"A vs C (different resource): {compare_plugin_resources(config_a, config_c)}")
print(f"B vs C (different resource): {compare_plugin_resources(config_b, config_c)}")
```

    A vs B (same resource): True
    A vs C (different resource): False
    B vs C (different resource): False

## Combined Resource Requirements

Get comprehensive resource requirements for a plugin.

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-resources/blob/main/cjm_fasthtml_resources/utils/plugin_utils.py#L70"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_plugin_resource_requirements

>  get_plugin_resource_requirements (plugin_id:str, plugin_registry,
>                                        plugin_config:Optional[Dict[str,Any]]=N
>                                        one)

*Get resource requirements for a plugin.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>plugin_id</td>
<td>str</td>
<td></td>
<td>Unique plugin ID</td>
</tr>
<tr>
<td>plugin_registry</td>
<td></td>
<td></td>
<td>Plugin registry instance with get_plugin, load_plugin_config
methods</td>
</tr>
<tr>
<td>plugin_config</td>
<td>Optional</td>
<td>None</td>
<td>Optional plugin configuration</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>Dict</strong></td>
<td></td>
<td><strong>Dictionary with resource requirement information (is_local,
uses_gpu, plugin_resource, device)</strong></td>
</tr>
</tbody>
</table>

This function is the main entry point for getting plugin resource
information. It combines all the other utility functions to provide a
complete picture of a plugin’s resource requirements.
